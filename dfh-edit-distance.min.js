(function(){var t,i,n,r,s,e;e=(window.dfh!=null?window.dfh:window.dfh={}).ed={};t=function(){function t(t){this.scale=t}t.prototype.distance=function(t,i){return this.analyze(t,i).distance};t.prototype.analyze=function(t,i){return this.table(t,i).finalCell()};t.prototype.edits=function(t,i){var n,r,s,e,h;e=this.chain(t,i);h=[];for(r=0,s=e.length;r<s;r++){n=e[r];h.push(n.edit())}return h};t.prototype.chain=function(t,i,n){var r,s,e;if(n==null){n=false}e=this.table(t,i);r=e.finalCell();s=[];while(!r.isRoot()){s.push(r);r=r.parent}if(n){s.push(e.root)}if(!this.scale.reversed){s=s.reverse()}return s};t.prototype.table=function(t,i){return new s(t,i,this.scale)};t.prototype.explain=function(t,i){return this.analyze(t,i).explain()};t.prototype.chart=function(t,i){return this.table(t,i).chart()};return t}();i=function(){function t(t,i,n,r,s,e,h,o){this.matrix=t;this.source=i;this.destination=n;this.s=r;this.d=s;this.distance=e;this.parent=h;this.edit=o}t.prototype.isRoot=function(){return!this.parent};t.prototype.cost=function(){if(!this.isRoot()){return this.c!=null?this.c:this.c=this.distance-this.parent.distance}};t.prototype.arrow=function(){if(this.isRoot()){return"·"}else if(this.s===this.parent.s){return"⇐"}else if(this.d===this.parent.d){return"⇑"}else{return"⇖"}};t.prototype.chart=function(t){var i;i=this.cost();if(this.s&&this.d){return"|"+this.arrow()+" "+t(i)}else if(this.s){return""+this.arrow()+this.source.at(this.s-1)+t(i)}else if(this.d){return"|"+this.arrow()+this.destination.at(this.d-1)+t(i)}else{return"  "+t(" ")}};t.prototype.initial=function(){var t;return(t=this.parent)!=null?t.isRoot():void 0};t.prototype.final=function(t){if(t==null){t=false}return t&&this.s===this.source.length()||!t&&this.d===this.destination.length()};t.prototype.chars=function(){var t,i;if(!this.myChars){if(this.s!==0){t=this.source.at(this.s-1)}if(this.d!==0){i=this.destination.at(this.d-1)}this.myChars=[t,i]}return this.myChars};t.prototype.describe=function(){var t,i,n,r;r=this.chars(),t=r[0],i=r[1];n=function(){switch(this.edit){case"a":return"kept "+t;case"i":return"inserted "+i;case"d":return"deleted "+t;case"s":return"substituted "+i+" for "+t}}.call(this);return""+n+" ("+this.cost()+")"};t.prototype.explain=function(){var t,i,n,r,s,e;t=this;n=[t];while(!(t=t.parent).isRoot()){n.unshift(t)}e=[];for(r=0,s=n.length;r<s;r++){i=n[r];e.push(i.describe())}return e};t.prototype.list=function(){return this.l!=null?this.l:this.l=[]};t.prototype.hash=function(){return this.h!=null?this.h:this.h={}};return t}();r=function(){function t(t){var i;this.s=t;this.chars=function(){var r,s,e;e=[];for(i=r=0,s=t.length;0<=s?r<s:r>s;i=0<=s?++r:--r){e.push(new n(t.charAt(i),i,t.length-i-1))}return e}()}t.prototype.at=function(t){return this.chars[t]};t.prototype.toString=function(){return this.s};t.prototype.length=function(){return this.s.length};return t}();n=function(){function t(t,i,n){this.c=t;this.pre=i;this.post=n}t.prototype.list=function(){return this.l!=null?this.l:this.l=[]};t.prototype.hash=function(){return this.h!=null?this.h:this.h={}};t.prototype.isFront=function(){return this.pre<this.post};t.prototype.isBack=function(){return this.post<this.pre};t.prototype.toString=function(){return this.c};return t}();s=function(){function t(t,n,s){var e,h,o,u,a,c,f,l,p,d,y,g,w,x,m,v,b,S,k,z,C,R,D;if(s.normalize){S=function(){var i,r,e,h;e=[t,n];h=[];for(i=0,r=e.length;i<r;i++){c=e[i];h.push(s.normalize(c))}return h}(),t=S[0],n=S[1]}this.source=new r(t);this.destination=new r(n);this.scale=s;this.sDim=f=t.length;this.dDim=h=n.length;this.matrix=new Array(f+1);for(u=p=0,k=this.sDim;0<=k?p<=k:p>=k;u=0<=k?++p:--p){this.matrix[u]=new Array(h+1)}this.root=new i(this,this.source,this.destination,0,0,0);this.matrix[0][0]=this.root;if(this.scale.prepare){this.scale.prepare(this)}z=f?function(){R=[];for(var t=1;1<=f?t<=f:t>=f;1<=f?t++:t--){R.push(t)}return R}.apply(this):[];for(d=0,w=z.length;d<w;d++){u=z[d];a=this.matrix[u-1][0];o="d";l=a.distance+s.weigh(a,o,u,0);this.matrix[u][0]=new i(this,this.source,this.destination,u,0,l,a,o)}C=h?function(){D=[];for(var t=1;1<=h?t<=h:t>=h;1<=h?t++:t--){D.push(t)}return D}.apply(this):[];for(g=0,x=C.length;g<x;g++){u=C[g];a=this.matrix[0][u-1];o="i";l=a.distance+s.weigh(a,o,0,u);this.matrix[0][u]=new i(this,this.source,this.destination,0,u,l,a,o)}if(f&&h){for(c=v=1;1<=f?v<=f:v>=f;c=1<=f?++v:--v){for(e=b=1;1<=h?b<=h:b>=h;e=1<=h?++b:--b){this.c(c,e)}}}}t.prototype.chart=function(){var t,i,n,r,s,e,h,o,u;r="";i=this.nformat();u=this.matrix;for(s=0,h=u.length;s<h;s++){n=u[s];for(e=0,o=n.length;e<o;e++){t=n[e];r+=t.chart(i)}r+="\n"}return r};t.prototype.finalCell=function(){return this.matrix[this.sDim][this.dDim]};t.prototype.cell=function(t,i){return this.matrix[t][i]};t.prototype.list=function(){return this.l!=null?this.l:this.l=[]};t.prototype.hash=function(){return this.h!=null?this.h:this.h={}};t.prototype.nformat=function(){var t,i,n,r,s,e,h,o,u,a,c,f;s=e=0;f=this.matrix;for(o=0,a=f.length;o<a;o++){h=f[o];for(u=0,c=h.length;u<c;u++){i=h[u];t=i.cost();if(t==null){continue}t=Math.abs(t).toString();n=t.replace(/(\d+)(\..*)?/,"$1").length;r=t.replace(/[^.]+\.?((.*))/,"$1").length;if(n>s){s=n}if(r>e){e=r}}}return function(t){var i,n,r,h;if(t===" "){n=e?s+e+2:s+1;return function(){var t,i;i=[];for(h=t=0;0<=n?t<n:t>n;h=0<=n?++t:--t){i.push(" ")}return i}().join("")}else{r=t<0?"-":" ";n=s-Math.trunc(Math.abs(t)).toString().length;n=function(){var t,r;r=[];for(i=t=0;0<=n?t<n:t>n;i=0<=n?++t:--t){r.push(" ")}return r}().join("");return n+r+t.toFixed(e).toString()}}};t.prototype.c=function(t,n){var r,s,e,h,o,u,a,c,f,l,p;a=t-1;h=n-1;e=this.matrix[a][h];if(this.source.at(a).c===this.destination.at(h).c){u=e;c=e.distance;o="a"}else{r=this.matrix[a][n];s=this.matrix[t][h];f=r.distance+this.scale.weigh(r,"d",t,n);l=s.distance+this.scale.weigh(s,"i",t,n);p=e.distance+this.scale.weigh(e,"s",t,n);if(f<p){if(f<l){u=r;c=f;o="d"}else{u=s;c=l;o="i"}}else if(l<p){u=s;c=l;o="i"}else{u=e;c=p;o="s"}}return this.matrix[t][n]=new i(this,this.source,this.destination,t,n,c,u,o)};return t}();e.analyzer=function(i){return new t(i)};e.lev=e.levenshtein=function(){return new t({weigh:function(t,i,n,r){return 1}})};e.cheapMargins=function(t,i,n,r,s){if(t==null){t=0}if(i==null){i=0}if(n==null){n=.25}if(r==null){r=1}if(s==null){s=0}return{isPrefixy:function(i,n){var r;if(t){return(r=i.at(n-1))&&r.isFront()&&r.pre<t}},isSuffixy:function(t,n){var r;if(i){return(r=t.at(n-1))&&r.isBack()&&r.post<i}},weigh:function(t,i,e,h){var o;o=function(){switch(i){case"d":if(this.isSuffixy(t.source,e)||this.isPrefixy(t.source,e)){return n}break;case"i":if(this.isSuffixy(t.destination,h)||this.isPrefixy(t.destination,h)){return n}break;case"s":if(this.isSuffixy(t.source,e)&&this.isSuffixy(t.destination,h)||this.isPrefixy(t.source,e)&&this.isPrefixy(t.destination,h)){return n}break;default:return s}}.call(this);return o!=null?o:o=r}}}}).call(this);