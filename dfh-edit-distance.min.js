(function(){var t,i,n,r,e,s;s=(window.dfh!=null?window.dfh:window.dfh={}).ed={};t=function(){function t(t){this.scale=t}t.prototype.distance=function(t,i){return this.analyze(t,i).distance};t.prototype.analyze=function(t,i){return this.table(t,i).finalCell()};t.prototype.edits=function(t,i){var n,r,e,s,h;s=this.chain(t,i);h=[];for(r=0,e=s.length;r<e;r++){n=s[r];h.push(n.edit())}return h};t.prototype.chain=function(t,i,n){var r,e,s;if(n==null){n=false}s=this.table(t,i);r=s.finalCell();e=[];while(!r.isRoot()){e.push(r);r=r.parent}if(n){e.push(s.root)}if(!this.scale.reversed){e=e.reverse()}return e};t.prototype.table=function(t,i){return new e(t,i,this.scale)};t.prototype.explain=function(t,i){return this.analyze(t,i).explain()};t.prototype.chart=function(t,i){return this.table(t,i).chart()};return t}();i=function(){function t(t,i,n,r,e,s,h,o){this.matrix=t;this.source=i;this.destination=n;this.s=r;this.d=e;this.distance=s;this.parent=h;this.edit=o}t.prototype.isRoot=function(){return!this.parent};t.prototype.cost=function(){if(!this.isRoot()){return this.c!=null?this.c:this.c=this.distance-this.parent.distance}};t.prototype.arrow=function(){if(this.isRoot()){return"·"}else if(this.s===this.parent.s){return"⇐"}else if(this.d===this.parent.d){return"⇑"}else{return"⇖"}};t.prototype.chart=function(t){var i;i=this.cost();if(this.s&&this.d){return"|"+this.arrow()+" "+t(i)}else if(this.s){return""+this.arrow()+this.source.at(this.s-1)+t(i)}else if(this.d){return"|"+this.arrow()+this.destination.at(this.d-1)+t(i)}else{return"  "+t(" ")}};t.prototype.initial=function(){var t;return(t=this.parent)!=null?t.isRoot():void 0};t.prototype.final=function(t){if(t==null){t=false}return t&&this.s===this.source.length()||!t&&this.d===this.destination.length()};t.prototype.chars=function(){return this.h!=null?this.h:this.h=function(t){return function(){var i,n;if(t.s!==0){i=t.source.at(t.s-1)}if(t.d!==0){n=t.destination.at(t.d-1)}return[i,n]}}(this)()};t.prototype.describe=function(){var t,i,n,r;r=this.chars(),t=r[0],i=r[1];n=function(){switch(this.edit){case"a":return"kept "+t;case"i":return"inserted "+i;case"d":return"deleted "+t;case"s":return"substituted "+i+" for "+t}}.call(this);return""+n+" ("+this.cost()+")"};t.prototype.explain=function(){var t,i,n,r,e,s;t=this;n=[t];while(!(t=t.parent).isRoot()){n.unshift(t)}s=[];for(r=0,e=n.length;r<e;r++){i=n[r];s.push(i.describe())}return s};t.prototype.list=function(){return this.l!=null?this.l:this.l=[]};t.prototype.hash=function(){return this.h!=null?this.h:this.h={}};return t}();r=function(){function t(t){var i;this.s=t;this.chars=function(){var r,e,s;s=[];for(i=r=0,e=t.length;0<=e?r<e:r>e;i=0<=e?++r:--r){s.push(new n(t.charAt(i),i,t.length-i-1))}return s}()}t.prototype.at=function(t){return this.chars[t]};t.prototype.toString=function(){return this.s};t.prototype.length=function(){return this.s.length};return t}();n=function(){function t(t,i,n){this.c=t;this.pre=i;this.post=n}t.prototype.list=function(){return this.l!=null?this.l:this.l=[]};t.prototype.hash=function(){return this.h!=null?this.h:this.h={}};t.prototype.isFront=function(){return this.pre<this.post};t.prototype.isBack=function(){return this.post<this.pre};t.prototype.toString=function(){return this.c};return t}();e=function(){function t(t,n,e){var s,h,o,u,a,c,f,l,p,d,y,g,w,x,v,m,b,S,k,z,R,D,P;if(e.normalize){S=function(){var i,r,s,h;s=[t,n];h=[];for(i=0,r=s.length;i<r;i++){c=s[i];h.push(e.normalize(c))}return h}(),t=S[0],n=S[1]}this.source=new r(t);this.destination=new r(n);this.scale=e;this.sDim=f=t.length;this.dDim=h=n.length;this.matrix=new Array(f+1);for(u=p=0,k=this.sDim;0<=k?p<=k:p>=k;u=0<=k?++p:--p){this.matrix[u]=new Array(h+1)}this.root=new i(this,this.source,this.destination,0,0,0);this.matrix[0][0]=this.root;if(this.scale.prepare){this.scale.prepare(this)}z=f?function(){D=[];for(var t=1;1<=f?t<=f:t>=f;1<=f?t++:t--){D.push(t)}return D}.apply(this):[];for(d=0,w=z.length;d<w;d++){u=z[d];a=this.matrix[u-1][0];o="d";l=a.distance+e.weigh(a,o,u,0);this.matrix[u][0]=new i(this,this.source,this.destination,u,0,l,a,o)}R=h?function(){P=[];for(var t=1;1<=h?t<=h:t>=h;1<=h?t++:t--){P.push(t)}return P}.apply(this):[];for(g=0,x=R.length;g<x;g++){u=R[g];a=this.matrix[0][u-1];o="i";l=a.distance+e.weigh(a,o,0,u);this.matrix[0][u]=new i(this,this.source,this.destination,0,u,l,a,o)}if(f&&h){for(c=m=1;1<=f?m<=f:m>=f;c=1<=f?++m:--m){for(s=b=1;1<=h?b<=h:b>=h;s=1<=h?++b:--b){this.c(c,s)}}}}t.prototype.chart=function(){var t,i,n,r,e,s,h,o,u;r="";i=this.nformat();u=this.matrix;for(e=0,h=u.length;e<h;e++){n=u[e];for(s=0,o=n.length;s<o;s++){t=n[s];r+=t.chart(i)}r+="\n"}return r};t.prototype.finalCell=function(){return this.matrix[this.sDim][this.dDim]};t.prototype.cell=function(t,i){return this.matrix[t][i]};t.prototype.list=function(){return this.l!=null?this.l:this.l=[]};t.prototype.hash=function(){return this.h!=null?this.h:this.h={}};t.prototype.nformat=function(){var t,i,n,r,e,s,h,o,u,a,c,f;e=s=0;f=this.matrix;for(o=0,a=f.length;o<a;o++){h=f[o];for(u=0,c=h.length;u<c;u++){i=h[u];t=i.cost();if(t==null){continue}t=Math.abs(t).toString();n=t.replace(/(\d+)(\..*)?/,"$1").length;r=t.replace(/[^.]+\.?((.*))/,"$1").length;if(n>e){e=n}if(r>s){s=r}}}return function(t){var i,n,r,h,o;if(t===" "){r=s?e+s+2:e+1;return function(){var t,i;i=[];for(o=t=0;0<=r?t<r:t>r;o=0<=r?++t:--t){i.push(" ")}return i}().join("")}else{h=t<0?"-":" ";i=Math.abs(t);r=e-Math.trunc(i).toString().length;r=function(){var t,i;i=[];for(n=t=0;0<=r?t<r:t>r;n=0<=r?++t:--t){i.push(" ")}return i}().join("");return r+h+i.toFixed(s).toString()}}};t.prototype.c=function(t,n){var r,e,s,h,o,u,a,c,f,l,p;a=t-1;h=n-1;s=this.matrix[a][h];if(this.source.at(a).c===this.destination.at(h).c){u=s;c=s.distance;o="a"}else{r=this.matrix[a][n];e=this.matrix[t][h];f=r.distance+this.scale.weigh(r,"d",t,n);l=e.distance+this.scale.weigh(e,"i",t,n);p=s.distance+this.scale.weigh(s,"s",t,n);if(f<p){if(f<l){u=r;c=f;o="d"}else{u=e;c=l;o="i"}}else if(l<p){u=e;c=l;o="i"}else{u=s;c=p;o="s"}}return this.matrix[t][n]=new i(this,this.source,this.destination,t,n,c,u,o)};return t}();s.analyzer=function(i){return new t(i)};s.lev=s.levenshtein=function(){return new t({weigh:function(t,i,n,r){return 1}})};s.cheapMargins=function(t,i,n,r,e){if(t==null){t=0}if(i==null){i=0}if(n==null){n=.25}if(r==null){r=1}if(e==null){e=0}return{isPrefixy:function(i,n){var r;if(t){return(r=i.at(n-1))&&r.isFront()&&r.pre<t}},isSuffixy:function(t,n){var r;if(i){return(r=t.at(n-1))&&r.isBack()&&r.post<i}},weigh:function(t,i,s,h){var o;o=function(){switch(i){case"d":if(this.isSuffixy(t.source,s)||this.isPrefixy(t.source,s)){return n}break;case"i":if(this.isSuffixy(t.destination,h)||this.isPrefixy(t.destination,h)){return n}break;case"s":if(this.isSuffixy(t.source,s)&&this.isSuffixy(t.destination,h)||this.isPrefixy(t.source,s)&&this.isPrefixy(t.destination,h)){return n}break;default:return e}}.call(this);return o!=null?o:o=r}}}}).call(this);