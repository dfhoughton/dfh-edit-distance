(function(){var t,i,s,n,r,e;e=(window.dfh!=null?window.dfh:window.dfh={}).ed={};t=function(){function t(t){this.scale=t}t.prototype.distance=function(t,i){return this.analyze(t,i).distance};t.prototype.analyze=function(t,i){return this.table(t,i).finalCell()};t.prototype.edits=function(t,i){var s,n,r,e,h;e=this.chain(t,i);h=[];for(n=0,r=e.length;n<r;n++){s=e[n];h.push(s.edit())}return h};t.prototype.chain=function(t,i,s){var n,r,e;if(s==null){s=false}e=this.table(t,i);n=e.finalCell();r=[];while(!n.isRoot()){r.push(n);n=n.parent}if(s){r.push(e.root)}if(!this.scale.reversed){r=r.reverse()}return r};t.prototype.table=function(t,i){return new r(t,i,this.scale)};t.prototype.explain=function(t,i){return this.analyze(t,i).explain()};t.prototype.chart=function(t,i,s){if(s==null){s=2}return this.table(t,i).chart(s)};return t}();i=function(){function t(t,i,s,n,r,e,h,o){this.matrix=t;this.source=i;this.destination=s;this.s=n;this.d=r;this.distance=e;this.parent=h;this.edit=o}t.prototype.isRoot=function(){return!this.parent};t.prototype.cost=function(){if(!this.isRoot()){return this.myCost!=null?this.myCost:this.myCost=this.distance-this.parent.distance}};t.prototype.arrow=function(){if(this.isRoot()){return"·"}else if(this.s===this.parent.s){return"⇐"}else if(this.d===this.parent.d){return"⇑"}else{return"⇖"}};t.prototype.chart=function(t){var i;if(t==null){t=2}if(this.s&&this.d){return"|"+this.arrow()+"   "+this.cost().toFixed(t)}else if(this.s){return""+this.arrow()+" "+this.source.at(this.s-1)+" "+this.cost().toFixed(t)}else if(this.d){return"|"+this.arrow()+" "+this.destination.at(this.d-1)+" "+this.cost().toFixed(t)}else{return"     "+function(){var s,n;n=[];for(i=s=0;0<=t?s<t:s>t;i=0<=t?++s:--s){n.push(" ")}return n}().join("")}};t.prototype.chars=function(){var t,i;if(!this.myChars){if(this.s!==0){t=this.source.at(this.s-1)}if(this.d!==0){i=this.destination.at(this.d-1)}this.myChars=[t,i]}return this.myChars};t.prototype.describe=function(){var t,i,s,n;n=this.chars(),t=n[0],i=n[1];s=function(){switch(this.edit){case"a":return"kept "+t;case"i":return"inserted "+i;case"d":return"deleted "+t;case"s":return"substituted "+i+" for "+t}}.call(this);return""+s+" ("+this.cost()+")"};t.prototype.explain=function(){var t,i,s,n,r,e;t=this;s=[t];while(!(t=t.parent).isRoot()){s.unshift(t)}e=[];for(n=0,r=s.length;n<r;n++){i=s[n];e.push(i.describe())}return e};t.prototype.list=function(){return this.l!=null?this.l:this.l=[]};t.prototype.hash=function(){return this.h!=null?this.h:this.h={}};return t}();n=function(){function t(t){var i;this.s=t;this.chars=function(){var n,r,e;e=[];for(i=n=0,r=t.length;0<=r?n<r:n>r;i=0<=r?++n:--n){e.push(new s(t.charAt(i),i,t.length-i-1))}return e}()}t.prototype.at=function(t){return this.chars[t]};t.prototype.toString=function(){return this.s};return t}();s=function(){function t(t,i,s){this.c=t;this.pre=i;this.post=s}t.prototype.list=function(){return this.l!=null?this.l:this.l=[]};t.prototype.hash=function(){return this.h!=null?this.h:this.h={}};t.prototype.isFront=function(){return this.pre<this.post};t.prototype.isBack=function(){return this.post<this.pre};t.prototype.toString=function(){return this.c};return t}();r=function(){function t(t,s,r){var e,h,o,u,a,c,f,l,p,d,y,w,x,m,v,g,b,C,S,k,z,D,F;if(r.normalize){C=function(){var i,n,e,h;e=[t,s];h=[];for(i=0,n=e.length;i<n;i++){c=e[i];h.push(r.normalize(c))}return h}(),t=C[0],s=C[1]}this.source=new n(t);this.destination=new n(s);this.scale=r;this.sDim=f=t.length;this.dDim=h=s.length;this.matrix=new Array(f+1);for(u=p=0,S=this.sDim;0<=S?p<=S:p>=S;u=0<=S?++p:--p){this.matrix[u]=new Array(h+1)}this.root=new i(this,this.source,this.destination,0,0,0);this.matrix[0][0]=this.root;if(this.scale.prepare){this.scale.prepare(this)}k=f?function(){D=[];for(var t=1;1<=f?t<=f:t>=f;1<=f?t++:t--){D.push(t)}return D}.apply(this):[];for(d=0,x=k.length;d<x;d++){u=k[d];a=this.matrix[u-1][0];o="d";l=a.distance+r.weigh(a,o,u,0);this.matrix[u][0]=new i(this,this.source,this.destination,u,0,l,a,o)}z=h?function(){F=[];for(var t=1;1<=h?t<=h:t>=h;1<=h?t++:t--){F.push(t)}return F}.apply(this):[];for(w=0,m=z.length;w<m;w++){u=z[w];a=this.matrix[0][u-1];o="i";l=a.distance+r.weigh(a,o,0,u);this.matrix[0][u]=new i(this,this.source,this.destination,0,u,l,a,o)}if(f&&h){for(c=g=1;1<=f?g<=f:g>=f;c=1<=f?++g:--g){for(e=b=1;1<=h?b<=h:b>=h;e=1<=h?++b:--b){this.c(c,e)}}}}t.prototype.chart=function(t){var i,s,n,r,e,h,o,u;if(t==null){t=2}n="";u=this.matrix;for(r=0,h=u.length;r<h;r++){s=u[r];for(e=0,o=s.length;e<o;e++){i=s[e];n+=i.chart(t)}n+="\n"}return n};t.prototype.finalCell=function(){return this.matrix[this.sDim][this.dDim]};t.prototype.cell=function(t,i){return this.matrix[t][i]};t.prototype.list=function(){return this.l!=null?this.l:this.l=[]};t.prototype.hash=function(){return this.h!=null?this.h:this.h={}};t.prototype.c=function(t,s){var n,r,e,h,o,u,a,c,f,l,p;a=t-1;h=s-1;e=this.matrix[a][h];if(this.source.at(a).c===this.destination.at(h).c){u=e;c=e.distance;o="a"}else{n=this.matrix[a][s];r=this.matrix[t][h];f=n.distance+this.scale.weigh(n,"d",t,s);l=r.distance+this.scale.weigh(r,"i",t,s);p=e.distance+this.scale.weigh(e,"s",t,s);if(f<p){if(f<l){u=n;c=f;o="d"}else{u=r;c=l;o="i"}}else if(l<p){u=r;c=l;o="i"}else{u=e;c=p;o="s"}}return this.matrix[t][s]=new i(this,this.source,this.destination,t,s,c,u,o)};return t}();e.analyzer=function(i){return new t(i)};e.lev=e.levenshtein=function(){return new t({weigh:function(t,i,s,n){return 1}})};e.cheapMargins=function(t,i,s,n,r){if(t==null){t=0}if(i==null){i=0}if(s==null){s=.25}if(n==null){n=1}if(r==null){r=0}return{isPrefixy:function(i,s){var n;if(t){return(n=i.at(s-1))&&n.isFront()&&n.pre<t}},isSuffixy:function(t,s){var n;if(i){return(n=t.at(s-1))&&n.isBack()&&n.post<i}},weigh:function(t,i,e,h){var o;o=function(){switch(i){case"d":if(this.isSuffixy(t.source,e)||this.isPrefixy(t.source,e)){return s}break;case"i":if(this.isSuffixy(t.destination,h)||this.isPrefixy(t.destination,h)){return s}break;case"s":if(this.isSuffixy(t.source,e)&&this.isSuffixy(t.destination,h)||this.isPrefixy(t.source,e)&&this.isPrefixy(t.destination,h)){return s}break;default:return r}}.call(this);return o!=null?o:o=n}}}}).call(this);